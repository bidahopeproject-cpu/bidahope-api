{
    admin off
    # Global option to prevent Caddy from trying to bind to port 80/443
    auto_https off
}

# Render provides the $PORT env var automatically
:{$PORT} {
    root * /var/www/html/public
    
    # PHP-FPM connection
    php_fastcgi 127.0.0.1:9000
    
    file_server
    
    # Security Headers
    header {
        Strict-Transport-Security "max-age=31536000; includeSubDomains; preload"
        X-Content-Type-Options "nosniff"
        X-Frame-Options "DENY"
        Referrer-Policy "no-referrer"
        X-XSS-Protection "1; mode=block"
        -Server
    }

    encode zstd gzip

    log {
        output stdout
    }
}